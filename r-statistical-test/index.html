<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>R-Statistical Test(모수 검정 vs 비모수 검정) | dohk’s AI &amp; bioinformatics</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="R-Statistical Test(모수 검정 vs 비모수 검정)" />
<meta name="author" content="Kwon DoHyung" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="contact on gwondohyung@gmail.com" />
<meta property="og:description" content="contact on gwondohyung@gmail.com" />
<link rel="canonical" href="https://tfedohk.github.io/dohk/r-statistical-test/" />
<meta property="og:url" content="https://tfedohk.github.io/dohk/r-statistical-test/" />
<meta property="og:site_name" content="dohk’s AI &amp; bioinformatics" />
<meta property="og:image" content="https://tfedohk.github.io/dohk/images/2020-11-06-r-statistical-test/Untitled14.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-06T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://tfedohk.github.io/dohk/r-statistical-test/","@type":"BlogPosting","headline":"R-Statistical Test(모수 검정 vs 비모수 검정)","dateModified":"2020-11-06T00:00:00-06:00","datePublished":"2020-11-06T00:00:00-06:00","image":"https://tfedohk.github.io/dohk/images/2020-11-06-r-statistical-test/Untitled14.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://tfedohk.github.io/dohk/r-statistical-test/"},"author":{"@type":"Person","name":"Kwon DoHyung"},"description":"contact on gwondohyung@gmail.com","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/dohk/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://tfedohk.github.io/dohk/feed.xml" title="dohk's AI &amp; bioinformatics" /><link rel="shortcut icon" type="image/x-icon" href="/dohk/images/favicon.ico"><link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css">

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/dohk/">dohk&#39;s AI &amp; bioinformatics</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/dohk/about/">About Me</a><a class="page-link" href="/dohk/search/">Search</a><a class="page-link" href="/dohk/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">R-Statistical Test(모수 검정 vs 비모수 검정)</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-11-06T00:00:00-06:00" itemprop="datePublished">
        Nov 6, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Kwon DoHyung</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/dohk/categories/#CSE">CSE</a>
        &nbsp;
      
        <a class="category-tags-link" href="/dohk/categories/#R">R</a>
        &nbsp;
      
        <a class="category-tags-link" href="/dohk/categories/#math">math</a>
        &nbsp;
      
        <a class="category-tags-link" href="/dohk/categories/#statistics">statistics</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          
          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#single-sample-t-test">single sample t-test </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Q-Q-plot:-Qunatile-Quantile-plot">Q-Q plot: Qunatile-Quantile plot </a>
<ul>
<li class="toc-entry toc-h3"><a href="#qqnorm()">qqnorm() </a></li>
<li class="toc-entry toc-h3"><a href="#qqplot()">qqplot() </a></li>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#SW-test:-Shapiro-Wilk-test(샤피로-윌크-검정)">SW-test: Shapiro-Wilk test(샤피로 윌크 검정) </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#KS-test:-Kolmogorov-Smirnov-test(콜모고로프-스미노트-검정)">KS-test: Kolmogorov-Smirnov test(콜모고로프-스미노트 검정) </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Paired-t-test">Paired t-test </a>
<ul>
<li class="toc-entry toc-h2"><a href="#등분산성-test:-bartlett-test">등분산성 test: bartlett test </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#t-test">t-test </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#독립표본-t-test-(independent-sample-t-test-또는-Student-sample-t-test)">독립표본 t-test (independent sample t-test 또는 Student sample t-test) </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실험-코드">실험 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Wilcox-test:-두-모집단의-중심-차이에-대한-비모수검정">Wilcox-test: 두 모집단의 중심 차이에 대한 비모수검정 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실험-코드-1">실험 코드 1 </a></li>
<li class="toc-entry toc-h3"><a href="#실험-코드-2">실험 코드 2 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#일원분산-분석:-one-way-ANOVA">일원분산 분석: one-way ANOVA </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Kruskal-Willis-검정">Kruskal-Willis 검정 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#실습-코드">실습 코드 </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#문제">문제 </a></li>
<li class="toc-entry toc-h1"><a href="#Reference">Reference </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-06-R-Statistical-Test.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="single-sample-t-test">
<a class="anchor" href="#single-sample-t-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>single sample t-test<a class="anchor-link" href="#single-sample-t-test"> </a>
</h1>
<p>해당 노트는 R에서 빈번하게 사용되는 통계 기법 등에 대해 다루는 노트다. 통계는 크게 모수 검정(parametric test)와 비모수 검정(non-parametic test)로 나눌 수 있다. R이 가정하는 것은 모집단이 정규분포를 따른다는 것이다. 정규분포를 따른다는 것은 평균이 0, 분산이 1인 경우를 말한다.</p>
<p>모집단이 정규 분포를 따르는 경우도 있지만 따르지 않는 경우도 있다. 모집단이 정규 분포를 따르는 경우를 모수 검정, 모집단이 정규 분포를 따르지 않는 경우를 비모수 검정이라고 한다.</p>
<p>비모수 검정은 표본수가 적거나 모집단이 정규분포임을 가정하기 어려운 경우, 측정 자료의 수준이 이산형 등의 categorical인 경우에 사용된다.</p>
<p>비교 그룹이 두 가지인 경우, 모수 검정으로는 paired t-test, independent (student) t-test를 통해 두 집단 간의 평균을 비교한다. 비모수 검정(즉, 정규 분포를 따르지 않는 경우)에서는 Mann-Whiteney U-test, Wilcoxon rank sum test, Crank Sum 비교, median 등을 사용된다. 특히, mean이 아닌 중간값(median)을 사용한다.</p>
<p>그룹이 세 개 이상인 경우의 비교에서, 모수 검정에서는 One-way ANOVA를 대표적으로 사용한다. 비모수 검정에서는 Kruskal-Willis test를 사용한다.</p>
<p>통계에서는 정규성을 따르는지 여부가 굉장히 중요하다. 내가 다루고자 하는 데이터가 정규성이 있는지 없는지 검증하는 과정이 내가 쓰고 있는 통계 기법에 대한 신뢰성을 보장해준다. 따라서 정규성 검증이 우선적으로 수행되어야 한다. 정규성 검증 방법으로 Q-Q plot 그리기, Shapiro-Wilk test(샤피로 윌크 검정), Kolmogorov-Smirnov test(콜모고로프-스미노트 검정)이 있다. 이 세 가지 방법으로 정규성을 따르는지 따진다. 각 테스트에서 p값이 0.05보다 커야 정규성을 따르는 것으로 판단할 수 있다.</p>
<h2 id="Q-Q-plot:-Qunatile-Quantile-plot">
<a class="anchor" href="#Q-Q-plot:-Qunatile-Quantile-plot" aria-hidden="true"><span class="octicon octicon-link"></span></a>Q-Q plot: Qunatile-Quantile plot<a class="anchor-link" href="#Q-Q-plot:-Qunatile-Quantile-plot"> </a>
</h2>
<p>실제 데이터값과 이론적 데이터값의 분포를 비교했을 때 어느 정도 일치하는지를 Plot으로, 즉 시각적으로 확인하는 방법이다. 대각선의 치우친 정도에 따라 정규성을 판단하게 된다. 따라서 해석이 주관적일 수 있다는 단점이 있다. 시각적인 방법 외에 p값을 판단하기 위한 통계적인 기법으로 Shapiro-Wilk test(샤피로 윌크 검정), Kolmogorov-Smirnov test(콜모고로프-스미노트 검정)이 있다.</p>
<h3 id="qqnorm()">
<a class="anchor" href="#qqnorm()" aria-hidden="true"><span class="octicon octicon-link"></span></a>qqnorm()<a class="anchor-link" href="#qqnorm()"> </a>
</h3>
<p>정규분포의 Q-Q plot을 그리는 함수. 1Q와 3Q를 지나는 선을 그리는 함수다. 정규분포일 경우 직선을 띈다.</p>
<h3 id="qqplot()">
<a class="anchor" href="#qqplot()" aria-hidden="true"><span class="octicon octicon-link"></span></a>qqplot()<a class="anchor-link" href="#qqplot()"> </a>
</h3>
<p>두 개의 자료가 같은 분포에서 추출되었는지를 검증한다. 같은 분포를 따를 경우 y=x 그래프로 나온다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">x</span><span class="o">&lt;-</span><span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">30</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># normal Q-Q plot 생성</span>
<span class="nf">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="c1"># 대각선 추가</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled.png" alt=""></p>
<p>오른쪽 대각선으로 직선의 모양을 띄고 있으므로 정규분포를 따른다고 추정할 수 있으며, 모수 추정법을 시도해 볼 수 있다.</p>
<h2 id="SW-test:-Shapiro-Wilk-test(샤피로-윌크-검정)">
<a class="anchor" href="#SW-test:-Shapiro-Wilk-test(%EC%83%A4%ED%94%BC%EB%A1%9C-%EC%9C%8C%ED%81%AC-%EA%B2%80%EC%A0%95)" aria-hidden="true"><span class="octicon octicon-link"></span></a>SW-test: Shapiro-Wilk test(샤피로 윌크 검정)<a class="anchor-link" href="#SW-test:-Shapiro-Wilk-test(%EC%83%A4%ED%94%BC%EB%A1%9C-%EC%9C%8C%ED%81%AC-%EA%B2%80%EC%A0%95)"> </a>
</h2>
<p>p &gt; 0.05일 경우 정규성을 띈다고 가정할 수 있다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">x</span><span class="o">&lt;-</span><span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">30</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled1.png" alt="">
p값이 0.9122로, 0.05보다 크므로 정규분포를 따른다고 가정할 수 있고 따라서 모수 추정법을 쓸 수 있다.</p>
<h2 id="KS-test:-Kolmogorov-Smirnov-test(콜모고로프-스미노트-검정)">
<a class="anchor" href="#KS-test:-Kolmogorov-Smirnov-test(%EC%BD%9C%EB%AA%A8%EA%B3%A0%EB%A1%9C%ED%94%84-%EC%8A%A4%EB%AF%B8%EB%85%B8%ED%8A%B8-%EA%B2%80%EC%A0%95)" aria-hidden="true"><span class="octicon octicon-link"></span></a>KS-test: Kolmogorov-Smirnov test(콜모고로프-스미노트 검정)<a class="anchor-link" href="#KS-test:-Kolmogorov-Smirnov-test(%EC%BD%9C%EB%AA%A8%EA%B3%A0%EB%A1%9C%ED%94%84-%EC%8A%A4%EB%AF%B8%EB%85%B8%ED%8A%B8-%EA%B2%80%EC%A0%95)"> </a>
</h2>
<p>Empirical Distribution Function(EDF)에 기반한 검정 방법. 자료의 평균과 표준편차, 히스토그램을 표준정규분포와 비교하여 적합도를 검정하며, p &gt; 0.05일 경우 정규성을 띈다고 가정할 수 있다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<p><strong>ks.test()</strong></p>
<div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">x</span><span class="o">&lt;-</span><span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">30</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="nf">ks.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">"pnorm"</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sd</span><span class="o">=</span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled2.png" alt=""></p>
<p>p값이 0.9952로, 0.05보다 크므로 정규분포를 따른다고 가정할 수 있고 따라서 모수 추정법을 쓸 수 있다.</p>
<p><strong>lillie.test()</strong></p>
<div class="highlight"><pre><span></span><span class="c1"># install.packages("nortest")</span>
<span class="nf">library</span><span class="p">(</span><span class="n">nortest</span><span class="p">)</span>

<span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">x</span><span class="o">&lt;-</span><span class="nf">sample</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">30</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">F</span><span class="p">)</span>
<span class="nf">lillie.test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled3.png" alt=""></p>
<p>p값이 0.961로, 0.05보다 크므로 정규분포를 따른다고 가정할 수 있고 따라서 모수 추정법을 쓸 수 있다.</p>
<hr>
<h1 id="Paired-t-test">
<a class="anchor" href="#Paired-t-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>Paired t-test<a class="anchor-link" href="#Paired-t-test"> </a>
</h1>
<p>두 집단 간의 대응 표본에 대한 t-검정을 말한다. 표본의 각 케이스마다 대응되는 두 개의 관측치가 있다는 관점에서 single sample t-test와는 차이가 있다.</p>
<p>각 환자가 주어지고, 동일한 집단에 속한 각 환자의 약물을 처리 전과 후를 비교하고자 할 때, 약물에 대한 효과를 보기 위해 검정하는 경우가 그 예다.</p>
<p>즉, 약물 처리 전과 후 두 그룹에 대한 t-test를 수행하기 위한 방법이다. 모수 검정이므로 우선 정규성이 만족되어야 하며, 두 집단간 분산이 등분산을 이루어야 한다. 이 두 조건을 만족하면 paired t-test를 사용할 수 있다.</p>
<h2 id="등분산성-test:-bartlett-test">
<a class="anchor" href="#%EB%93%B1%EB%B6%84%EC%82%B0%EC%84%B1-test:-bartlett-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>등분산성 test: bartlett test<a class="anchor-link" href="#%EB%93%B1%EB%B6%84%EC%82%B0%EC%84%B1-test:-bartlett-test"> </a>
</h2>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="n">before</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.430</span><span class="p">,</span> <span class="m">0.266</span><span class="p">,</span> <span class="m">0.567</span><span class="p">,</span> <span class="m">0.531</span><span class="p">,</span> <span class="m">0.707</span><span class="p">,</span> <span class="m">0.716</span><span class="p">,</span> <span class="m">0.651</span><span class="p">,</span> <span class="m">0.589</span><span class="p">,</span> <span class="m">0.469</span><span class="p">,</span> <span class="m">0.723</span><span class="p">)</span>
<span class="n">after</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.415</span><span class="p">,</span> <span class="m">0.238</span><span class="p">,</span> <span class="m">0.390</span><span class="p">,</span> <span class="m">0.410</span><span class="p">,</span> <span class="m">0.605</span><span class="p">,</span> <span class="m">0.609</span><span class="p">,</span> <span class="m">0.632</span><span class="p">,</span> <span class="m">0.523</span><span class="p">,</span> <span class="m">0.411</span><span class="p">,</span> <span class="m">0.612</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">before</span> <span class="o">=</span> <span class="n">before</span><span class="p">,</span> <span class="n">after</span> <span class="o">=</span> <span class="n">after</span><span class="p">)</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled4.png" alt=""></p>
<div class="highlight"><pre><span></span><span class="nf">var.test</span><span class="p">(</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">before</span><span class="p">,</span> <span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">after</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled5.png" alt=""></p>
<p>p-value값이 0.7441로 나온다. 0.05보다 큰 값이므로 두 집단의 등분산성을 인정할 수 있다.</p>
<h2 id="t-test">
<a class="anchor" href="#t-test" aria-hidden="true"><span class="octicon octicon-link"></span></a>t-test<a class="anchor-link" href="#t-test"> </a>
</h2>
<p>두 집단이 등분산을 이루고 있으므로 두 집단 간이 정규분포를 따르는지를 따지기 위한 t-test를 수행해야 한다.</p>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled6.png" alt=""></p>
<p>t-test() 함수에서 요구하는 파라미터는 위와 같다. 만약 y를 기술하지 않으면 single sample에 대한 t-test가 된다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="nf">t.test</span><span class="p">(</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">before</span><span class="p">,</span> <span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">after</span><span class="p">,</span> <span class="n">paired</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled7.png" alt=""></p>
<p>mean of the differences는 두 집단 간 평균의 차이를 의미한다.</p>
<h1 id="독립표본-t-test-(independent-sample-t-test-또는-Student-sample-t-test)">
<a class="anchor" href="#%EB%8F%85%EB%A6%BD%ED%91%9C%EB%B3%B8-t-test-(independent-sample-t-test-%EB%98%90%EB%8A%94-Student-sample-t-test)" aria-hidden="true"><span class="octicon octicon-link"></span></a>독립표본 t-test (independent sample t-test 또는 Student sample t-test)<a class="anchor-link" href="#%EB%8F%85%EB%A6%BD%ED%91%9C%EB%B3%B8-t-test-(independent-sample-t-test-%EB%98%90%EB%8A%94-Student-sample-t-test)"> </a>
</h1>
<p>비교하려는 집단은 서로 독립적인 집단에서 추출된 샘플이며, 이 두 집단의 샘플에 대한 <strong>평균의 차이</strong>를 통계적으로 검정한다. 즉, 모집단이 서로 다르다. 그러므로 상관성이 서로 없을 가능성이 크다. 따라서 두 집단의 평균의 차이를 검증해야 한다.</p>
<p>R에 내장된 데이터셋을 살피기 위해 <code>data()</code>를 입력한다.</p>
<div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled8.png" alt=""></p>
<p>이들 중 iris를 사용할 예정이다.</p>
<h3 id="실험-코드">
<a class="anchor" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실험 코드<a class="anchor-link" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="c1"># iris</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="s">"Species"</span><span class="p">,</span> <span class="s">"Sepal.Length"</span><span class="p">)]</span> <span class="c1"># 종과 꽃잎의 길이만 비교하겠다.</span>
<span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">"species"</span><span class="p">,</span> <span class="s">"sepal"</span><span class="p">)</span>

<span class="c1"># bartlett test</span>
<span class="nf">bartlett.test</span><span class="p">(</span><span class="n">sepal</span><span class="o">~</span><span class="n">species</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span> <span class="c1"># p-value가 적으므로 분산이 이질적이라고 할 수 있다. </span>

<span class="c1"># t-test</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">sepal</span><span class="o">~</span><span class="n">species</span><span class="p">,</span> <span class="n">var.eqaul</span><span class="o">=</span><span class="bp">F</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled9.png" alt=""></p>
<p>p 값이 차이가 있기 때문에 두 집단 즉 Species(종)과 sepal.Length(꽃잎의 길이)간에는 확연한 차이가 있다고 판단할 수 있다.</p>
<h1 id="Wilcox-test:-두-모집단의-중심-차이에-대한-비모수검정">
<a class="anchor" href="#Wilcox-test:-%EB%91%90-%EB%AA%A8%EC%A7%91%EB%8B%A8%EC%9D%98-%EC%A4%91%EC%8B%AC-%EC%B0%A8%EC%9D%B4%EC%97%90-%EB%8C%80%ED%95%9C-%EB%B9%84%EB%AA%A8%EC%88%98%EA%B2%80%EC%A0%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>Wilcox-test: 두 모집단의 중심 차이에 대한 비모수검정<a class="anchor-link" href="#Wilcox-test:-%EB%91%90-%EB%AA%A8%EC%A7%91%EB%8B%A8%EC%9D%98-%EC%A4%91%EC%8B%AC-%EC%B0%A8%EC%9D%B4%EC%97%90-%EB%8C%80%ED%95%9C-%EB%B9%84%EB%AA%A8%EC%88%98%EA%B2%80%EC%A0%95"> </a>
</h1>
<p>독립표본 t-test (independent sample t-test 또는 Student sample t-test)이 정규성을 충족하는 두 집단 간의 평균의 차이를 이용하여 비교하는 검정법이었다. 만약 비교하려는 두 집단이 정규성을 충족하지 못하는 경우이거나 그 분포의 형태를 알 수 없을 경우엔 정규성을 충족하지 못함을 가정하여 비모수 검정을 사용한다. 이 때 wilcox-test를 수행하게 된다. 즉 모집단이 정규성 가정을 충족하지 못하거나, 모집단의 분포 형태를 모르는 경우에 사용된다. 두 모집단의 중심(median)의 차이에 대한 비모수 검정이며, 다른 말로는 wilcoxon rank sum test, Mann-Whiteney U-test라고도 한다.</p>
<h3 id="실험-코드-1">
<a class="anchor" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>실험 코드 1<a class="anchor-link" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C-1"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="c1">## 정규성을 충족하지 못하는 두 모집단의 중심 차이에 대한 비모수검정</span>
<span class="c1">## Wilcox rank sum test, Mann-Whiteney U-test</span>
<span class="c1">## Dataset</span>
<span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>
<span class="c1">#str(Cars93)</span>
<span class="c1">#head(Cars93)</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">Price</span> <span class="o">~</span> <span class="n">Origin</span><span class="p">,</span> 
            <span class="n">data</span><span class="o">=</span><span class="n">Cars93</span><span class="p">,</span> 
            <span class="n">alternative</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">"two.sided"</span><span class="p">),</span> 
            <span class="n">mu</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> 
            <span class="n">conf.int</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> 
            <span class="n">conf.level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled10.png" alt=""></p>
<p>p 값이 0.6724로 0.05보다 크므로 두 집단 간에는 차이가 없다고 할 수 있다.</p>
<h3 id="실험-코드-2">
<a class="anchor" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>실험 코드 2<a class="anchor-link" href="#%EC%8B%A4%ED%97%98-%EC%BD%94%EB%93%9C-2"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="c1">## paired 2 sample : Wilcoxon signed rank test</span>
<span class="c1"># 정규성을 따르지 않는 10명의 환자의 치료제에 복용에 따른 혈중 타겟 단백질 농도 비교시 </span>
<span class="n">before</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">51.4</span><span class="p">,</span> <span class="m">52.0</span><span class="p">,</span> <span class="m">45.5</span><span class="p">,</span> <span class="m">54.5</span><span class="p">,</span> <span class="m">52.3</span><span class="p">,</span> <span class="m">50.9</span><span class="p">,</span> <span class="m">52.7</span><span class="p">,</span> <span class="m">50.3</span><span class="p">,</span> <span class="m">53.8</span><span class="p">,</span> <span class="m">53.1</span><span class="p">)</span>
<span class="n">after</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">50.1</span><span class="p">,</span> <span class="m">51.5</span><span class="p">,</span> <span class="m">45.9</span><span class="p">,</span> <span class="m">53.1</span><span class="p">,</span> <span class="m">51.8</span><span class="p">,</span> <span class="m">50.3</span><span class="p">,</span> <span class="m">52.0</span><span class="p">,</span> <span class="m">49.9</span><span class="p">,</span> <span class="m">52.5</span><span class="p">,</span> <span class="m">53.0</span><span class="p">)</span>

<span class="c1"># wilcox signed rank test</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">,</span> 
            <span class="n">alternative</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">"greater"</span><span class="p">),</span> 
            <span class="n">paired</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
            <span class="n">conf.level</span> <span class="o">=</span> <span class="m">0.95</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled11.png" alt=""></p>
<p>p가 0.05보다 충분히 작은 값인 0.006172이므로 두 집단 간에 차이가 있다고 판단할 수 있다.</p>
<h1 id="일원분산-분석:-one-way-ANOVA">
<a class="anchor" href="#%EC%9D%BC%EC%9B%90%EB%B6%84%EC%82%B0-%EB%B6%84%EC%84%9D:-one-way-ANOVA" aria-hidden="true"><span class="octicon octicon-link"></span></a>일원분산 분석: one-way ANOVA<a class="anchor-link" href="#%EC%9D%BC%EC%9B%90%EB%B6%84%EC%82%B0-%EB%B6%84%EC%84%9D:-one-way-ANOVA"> </a>
</h1>
<p>모두 검정 중 정규성을 충족하나, 비교하려는 집단이 세 개 이상인 경우에 해당한다. 두 집단일 경우 평균이나 중간값을 비교했다. 그러나 집단이 세 개 이상인 경우에는 집단 내에서의 분포가 얼마나 차이가 있는지 분산을 비교해야 한다. A집단 내의 분산, B집단 내의 분산이 다르다면 두 집단은 다르다고 판단할 수 있는 원리다. 즉 세 개의 집단에 대한 분산을 비교한다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="c1">## One-way ANOVA :One-way ANOVA : aov(), oneway.test</span>
<span class="c1"># 정규성을 충족하는 독립된 세 집단 이상의 평균을 비교하고자 할 때 사용하는 분석 방법</span>
<span class="c1">##--- Are there any daily outcome differences among temperature conditions?</span>
<span class="c1"># group 1 : temperature condition 1 </span>
<span class="c1"># group 2 : temperature condition 2</span>
<span class="c1"># group 3 : temperature condition 3</span>

<span class="c1"># daily outcome by tmep condition (group 1/2/3)</span>
<span class="n">outcome01</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50.5</span><span class="p">,</span> <span class="m">52.1</span><span class="p">,</span> <span class="m">51.9</span><span class="p">,</span> <span class="m">52.4</span><span class="p">,</span> <span class="m">50.6</span><span class="p">,</span> <span class="m">51.4</span><span class="p">,</span> <span class="m">51.2</span><span class="p">,</span> <span class="m">52.2</span><span class="p">,</span> <span class="m">51.5</span><span class="p">,</span> <span class="m">50.8</span><span class="p">)</span>
<span class="n">outcome02</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">47.5</span><span class="p">,</span> <span class="m">47.7</span><span class="p">,</span> <span class="m">46.6</span><span class="p">,</span> <span class="m">47.1</span><span class="p">,</span> <span class="m">47.2</span><span class="p">,</span> <span class="m">47.8</span><span class="p">,</span> <span class="m">45.2</span><span class="p">,</span> <span class="m">47.4</span><span class="p">,</span> <span class="m">45.0</span><span class="p">,</span> <span class="m">47.9</span><span class="p">)</span>
<span class="n">outcome03</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">46.0</span><span class="p">,</span> <span class="m">47.1</span><span class="p">,</span> <span class="m">45.6</span><span class="p">,</span> <span class="m">47.1</span><span class="p">,</span> <span class="m">47.2</span><span class="p">,</span> <span class="m">46.4</span><span class="p">,</span> <span class="m">45.9</span><span class="p">,</span> <span class="m">47.1</span><span class="p">,</span> <span class="m">44.9</span><span class="p">,</span> <span class="m">46.2</span><span class="p">)</span>

<span class="n">outcome</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">outcome01</span><span class="p">,</span> <span class="n">outcome02</span><span class="p">,</span> <span class="n">outcome03</span><span class="p">)</span>
<span class="n">group</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">"G1"</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="s">"G2"</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="s">"G3"</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>

<span class="c1">## 데이터 프레임으로 결합</span>
<span class="n">group_outcome</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">group_outcome</span><span class="p">)</span>

<span class="c1"># descriptive statistics by group</span>
<span class="nf">tapply</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">summary</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled12.png" alt=""></p>
<ul>
<li>
<code>tapply()</code> 함수는 테이블 형태의 데이터에 적용할 수 있는 apply 함수다.</li>
</ul>
<p>정규성을 충족하고 있다. 이제, 등분산성을 검증해야 한다.</p>
<div class="highlight"><pre><span></span><span class="c1">## Bartlett test (등분산성 검증)</span>
<span class="nf">bartlett.test</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span> <span class="n">group</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">group_outcome</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled13.png" alt=""></p>
<p>p값이 0.4368로 충분히 크다. 등분산성을 이루고 있다고 할 수 있다.</p>
<p>정규성과 등분산성이 모두 충족되므로 모수 검정을 실시할 수 있게 된다.</p>
<div class="highlight"><pre><span></span><span class="c1">## one-way ANOVA</span>
<span class="nf">aov</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span><span class="n">group</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">group_outcome</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">aov</span><span class="p">(</span><span class="n">outcome</span> <span class="o">~</span><span class="n">group</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">group_outcome</span><span class="p">))</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled14.png" alt=""></p>
<p>그룹간 Residuals가 주어지고, 그것에 대한 통계처리된 값들이 나온다. p값이 1.2e-13으로 작게 나온다. 즉 세 그룹은 서로 다르다고 할 수 있다. ANOVA의 단점은 어느 그룹과 어느 그룹이 차이가 있는지는 보여주지 못한다는 단점이 있다.</p>
<h1 id="Kruskal-Willis-검정">
<a class="anchor" href="#Kruskal-Willis-%EA%B2%80%EC%A0%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kruskal-Willis 검정<a class="anchor-link" href="#Kruskal-Willis-%EA%B2%80%EC%A0%95"> </a>
</h1>
<p>세 집단을 비교하는 방법으로 정규성을 충족하지 않는 집단에 대한 비모수 검정 방법에 해당한다. 비모수 검정은 평균이 아닌 중간값을 비교하듯, 이 방법도 크기순으로 정렬한 후 가장 작은 값부터 순위를 메겨, 그룹별 순위합을 구하는 방법이다. 그룹 간에 순위합에 차이가 없다면 순위합도 비슷하다고 할 수 있고, 크기 차이가 많이 난다면 순위합도 차이가 많이 날 것이라는 기본적인 가정하에 나온 기법이다.</p>
<p>데이터에 대한 등분산 검증을 먼저 실시하게 된다. 정규성을 띌 경우 bartlett-test를 실시하지만, 여기서는 정규성을 띄지 않으므로 levene test를 실시한다.</p>
<h3 id="실습-코드">
<a class="anchor" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>실습 코드<a class="anchor-link" href="#%EC%8B%A4%EC%8A%B5-%EC%BD%94%EB%93%9C"> </a>
</h3>
<div class="highlight"><pre><span></span><span class="c1">## 정규성을 충족하지 않는 K개의 독립진단에 대한 비모수 검정</span>
<span class="c1">## Kruskal-Willis 검정 </span>
<span class="n">value1</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">98</span><span class="p">,</span><span class="m">95</span><span class="p">,</span><span class="m">76</span><span class="p">,</span><span class="m">95</span><span class="p">,</span><span class="m">83</span><span class="p">,</span><span class="m">99</span><span class="p">,</span><span class="m">82</span><span class="p">,</span><span class="m">75</span><span class="p">,</span><span class="m">88</span><span class="p">)</span>
<span class="n">value2</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">95</span><span class="p">,</span><span class="m">71</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">81</span><span class="p">,</span><span class="m">77</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">72</span><span class="p">,</span><span class="m">81</span><span class="p">)</span>
<span class="n">value3</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">77</span><span class="p">,</span><span class="m">79</span><span class="p">,</span><span class="m">91</span><span class="p">,</span><span class="m">84</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">93</span><span class="p">,</span><span class="m">87</span><span class="p">,</span><span class="m">81</span><span class="p">,</span><span class="m">83</span><span class="p">)</span>
<span class="n">category</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="s">"A"</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="s">"B"</span><span class="p">,</span><span class="m">9</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="s">"C"</span><span class="p">,</span><span class="m">9</span><span class="p">))</span>
<span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">),</span> <span class="n">category</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1">## 등분산 검증 (levene.test) </span>
<span class="c1">## levene test는 barlettetest 보다 정규성을 띠지 않는 경우에 보다 민감</span>
<span class="c1">#install.packages("lawstat")</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lawstat</span><span class="p">)</span>

<span class="nf">levene.test</span><span class="p">(</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">value</span><span class="p">,</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">category</span><span class="p">)</span>

<span class="c1">## Kruskal-Willis</span>
<span class="nf">kruskal.test</span><span class="p">(</span><span class="n">value</span><span class="o">~</span><span class="n">category</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
<p><img src="/dohk/images/copied_from_nb/../images/2020-11-06-r-statistical-test/Untitled15.png" alt=""></p>
<p>등분산을 띄고(P-value: 0.2023 &gt; 0.05), Kruskal-Wallis test에서 나온 P-value가 0.05793으로 0.05보다 크므로 세 집단에는 통계적으로 차이가 없다고 볼 수 있다.</p>
<h1 id="문제">
<a class="anchor" href="#%EB%AC%B8%EC%A0%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C"> </a>
</h1>
<p>다음은 A집단과 B집단의 키를 측정한 결과이다. A와 B 그룹 사이에 신장 차이가 있는지 판단하기 위해 사용되는 R 통계방법을 모두 고르시오.</p>
<p>A = c(171.2, 190.1, 184.3, 179.6, 183.2, 174.1, 186.7, 187.2, 187.2, 179.5)
B = c(175.3, 176.1, 173.2, 176.7, 181.3, 178.6, 180.2, 172.6, 180.9, 172.1)</p>
<ul>
<li>[ ]  t.test(A~B)</li>
<li>[ ]  var.test(A, B)</li>
<li>[ ]  aov(A, B)</li>
<li>[ ]  wilcox.test(A~B)</li>
<li>[ ]  t.test(A, B)</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">171.2</span><span class="p">,</span> <span class="m">190.1</span><span class="p">,</span> <span class="m">184.3</span><span class="p">,</span> <span class="m">179.6</span><span class="p">,</span> <span class="m">183.2</span><span class="p">,</span> <span class="m">174.1</span><span class="p">,</span> <span class="m">186.7</span><span class="p">,</span> <span class="m">187.2</span><span class="p">,</span> <span class="m">187.2</span><span class="p">,</span> <span class="m">179.5</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">175.3</span><span class="p">,</span> <span class="m">176.1</span><span class="p">,</span> <span class="m">173.2</span><span class="p">,</span> <span class="m">176.7</span><span class="p">,</span> <span class="m">181.3</span><span class="p">,</span> <span class="m">178.6</span><span class="p">,</span> <span class="m">180.2</span><span class="p">,</span> <span class="m">172.6</span><span class="p">,</span> <span class="m">180.9</span><span class="p">,</span> <span class="m">172.1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="p">)</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data</span>
<span class="nf">var.test</span><span class="p">(</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">A</span><span class="p">,</span> <span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">B</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">A</span><span class="p">,</span> <span class="nf">data</span><span class="p">(</span>달러표시<span class="p">)</span><span class="n">B</span><span class="p">)</span>
</pre></div>
<p>또는</p>
<div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">171.2</span><span class="p">,</span> <span class="m">190.1</span><span class="p">,</span> <span class="m">184.3</span><span class="p">,</span> <span class="m">179.6</span><span class="p">,</span> <span class="m">183.2</span><span class="p">,</span> <span class="m">174.1</span><span class="p">,</span> <span class="m">186.7</span><span class="p">,</span> <span class="m">187.2</span><span class="p">,</span> <span class="m">187.2</span><span class="p">,</span> <span class="m">179.5</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">175.3</span><span class="p">,</span> <span class="m">176.1</span><span class="p">,</span> <span class="m">173.2</span><span class="p">,</span> <span class="m">176.7</span><span class="p">,</span> <span class="m">181.3</span><span class="p">,</span> <span class="m">178.6</span><span class="p">,</span> <span class="m">180.2</span><span class="p">,</span> <span class="m">172.6</span><span class="p">,</span> <span class="m">180.9</span><span class="p">,</span> <span class="m">172.1</span><span class="p">)</span>
<span class="nf">var.test</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">A</span><span class="o">~</span><span class="n">B</span><span class="p">)</span>
</pre></div>
<h1 id="Reference">
<a class="anchor" href="#Reference" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reference<a class="anchor-link" href="#Reference"> </a>
</h1>
<ul>
<li><a href="https://m.blog.naver.com/PostView.nhn?blogId=dic1224&amp;logNo=80209540135&amp;proxyReferer=https:%2F%2Fwww.google.com%2F">https://m.blog.naver.com/PostView.nhn?blogId=dic1224&amp;logNo=80209540135&amp;proxyReferer=https:%2F%2Fwww.google.com%2F</a></li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="tfedohk/dohk"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/dohk/r-statistical-test/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/dohk/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/dohk/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/dohk/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>contact on gwondohyung@gmail.com</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/tfedohk" title="tfedohk"><svg class="svg-icon grey"><use xlink:href="/dohk/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/dohk/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
